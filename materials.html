<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>CampusConnect — Materials</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <header class="topbar">
      <a class="nav-home" href="index.html">← Home</a>
      <div id="userBadge" class="user-badge"></div>
      <button class="btnalt" onclick="logout()">🚪 Logout</button>
    </header>

    <main class="container">
      <section class="card">
        <h2>Share study material</h2>
        <input id="matTitle" placeholder="Title e.g. COS201 Lecture 5" />
        <input id="matCourse" placeholder="Course e.g. Algorithms" />
        <textarea
          id="matDesc"
          rows="3"
          placeholder="Short description"
        ></textarea>
        <label class="file-row">
          Attach file (optional)
          <input id="matFile" type="file" accept=".pdf,image/*,text/*" />
        </label>
        <div class="row">
          <button id="shareMatBtn" class="btn primary">Share</button>
        </div>
      </section>

      <section class="card">
        <h2>Shared materials</h2>
        <input id="materialsSearch" placeholder="Search materials..." />
        <div id="materialsList" class="materials-list"></div>
      </section>
    </main>

    <div id="confetti-wrapper"></div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
      import {
        getAuth,
        onAuthStateChanged,
        signOut,
      } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";

      const firebaseConfig = {
        apiKey: "AIzaSyBNgmIM9ZuvZ6XGXBLwwjvcA_0iZFeEFgM",
        authDomain: "xhaw-38afb.firebaseapp.com",
        databaseURL: "https://xhaw-38afb-default-rtdb.firebaseio.com",
        projectId: "xhaw-38afb",
        storageBucket: "xhaw-38afb.appspot.com",
        messagingSenderId: "1083342543018",
        appId: "1:1083342543018:web:197cae3d50914ba34098d3",
        measurementId: "G-86ELK1E11Y",
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      onAuthStateChanged(auth, (user) => {
        const badge = document.getElementById("userBadge");
        if (!user) window.location.href = "signin.html";
        else badge.innerText = `👤 ${user.email}`;
      });

      window.logout = async function () {
        await signOut(auth);
        window.location.href = "signin.html";
      };
    </script>

    <script src="js/materials.js"></script>
  </body>
</html>
